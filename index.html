<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>Fruit</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"PingFang SC","Microsoft YaHei",sans-serif;background:#f5f6fa;color:#111}
#content{max-width:520px;margin:0 auto;padding:12px;text-align:center}

/* â€”â€” ç”¨æ•´ä½“ç¼©æ”¾é€‚é…æ‰‹æœºï¼šå†…éƒ¨ä»æŒ‰ä½ åŸæ¥åƒç´ åæ ‡ â€”â€” */
.scale-wrap{width:1000px;height:1200px;margin:0 auto;transform-origin:top center;position:relative}
@media (max-width:520px){
  .scale-wrap{transform:scale(calc((100vw - 24px)/1000));
              height:calc(1200px * ((100vw - 24px)/1000));}
}

/* â€”â€” ç›˜é¢ï¼ˆåæ ‡/é¡ºåº/é€»è¾‘ä¸å˜ï¼‰ â€”â€” */
.box{width:1000px;height:1200px;background:#2b62ff;position:relative;border-radius:12px}
.top{width:600px;height:100px;display:flex;position:absolute;top:50px;left:150px}
.right{width:100px;height:600px;position:absolute;top:50px;right:150px;display:flex;flex-direction:column}
.bottom{width:600px;height:100px;display:flex;flex-direction:row-reverse;position:absolute;top:650px;right:150px}
.left{width:100px;height:600px;display:flex;flex-flow:column-reverse;position:absolute;top:150px;left:150px}

/* ç»Ÿä¸€å›¾æ ‡å°ºå¯¸ï¼ˆç›˜é¢æ¯æ ¼ 98Ã—98ï¼‰ */
.cell{
  width:98px;height:98px;border:1px solid #000;background:#fff;border-radius:10px;
  display:flex;align-items:center;justify-content:center;font-weight:700;font-size:42px;user-select:none
}
.double{letter-spacing:1px}
.lucky{font-size:32px} /* LUCKY æ›´å°ï¼Œå®Œå…¨åœ¨æ¡†å†… */

/* ç§»åŠ¨é«˜äº®ï¼šé»„è‰²ï¼Œä¸é®å†…å®¹ */
#move{
  display:block;width:98px;height:98px;position:absolute;top:50px;left:150px;
  border:3px solid #ffd400;outline:4px solid rgba(255,212,0,.35);
  box-shadow:0 0 12px rgba(255,212,0,.5), inset 0 0 6px rgba(255,212,0,.3);
  background:transparent;pointer-events:none
}

/* é‡‘é¢ä¿¡æ¯ï¼ˆä¿ç•™åŸ IDï¼‰ */
#getScore,#allScore{
  display:block;width:200px;height:50px;font-size:24px;line-height:50px;color:#111;background:#fff;border-radius:8px;position:absolute;top:200px
}
#getScore{left:290px} #allScore{right:290px}
#getScore>p,#allScore>p{display:inline-block;min-width:60px;font-weight:700;margin-left:8px}

/* å……å€¼æŒ‰é’®ä¿ç•™ï¼ˆåŸä½ï¼‰ */
#change{width:120px;height:36px;position:absolute;top:25px;right:15px;border-radius:8px;border:0;background:#111;color:#fff}

/* â€”â€” åº•éƒ¨ä¸€æ’ï¼šæ”¾åœ¨ç›˜é¢å†…éƒ¨ï¼Œç²¾ç¡®å®šä½åœ¨åŒ7ä¸‹é¢ä¸€ä¸ªå›¾æ ‡è·ç¦» â€”â€” */
/* åŒ7è¿™ä¸€æ’ bottom çš„ top = 650ï¼Œæ ¼é«˜ = 98 â†’ åº•è¾¹ y = 748ï¼›å†åŠ ä¸€ä¸ªæ ¼é«˜ 98 â†’ 846 */
.controlbar{
  position:absolute; top:848px; left:50%; transform:translateX(-50%);
  width:946px;  /* 9ä¸ªæŒ‰é’®*98 + 8ä¸ªé—´éš”*8 = 882 + 64 = 946 */
  display:flex;justify-content:center;gap:8px;
}
.btn-icon{
  width:98px;height:98px;
  display:flex;align-items:center;justify-content:center;
  background:#fff;border:1px solid #000;border-radius:10px;
  font-size:58px;font-weight:700;position:relative;user-select:none
}
.btn-icon:active{transform:scale(.97)}
.btn-text{font-size:46px}
.badge{
  position:absolute;right:6px;bottom:6px;min-width:22px;height:20px;padding:0 4px;
  background:#111;color:#fff;border-radius:6px;font-size:12px;display:flex;align-items:center;justify-content:center;font-weight:700;
}

/* â€”â€” éšè—ä½†ä¿ç•™åŸä¸‹æ³¨ç»“æ„ï¼ˆé¡ºåºä¸å˜ï¼Œä¾›åŸé€»è¾‘ä½¿ç”¨ï¼‰ â€”â€” */
.stake{height:0;overflow:hidden}
.stake .minus,.stake .add{display:none}
.note{margin-top:6px;color:#666;font-size:12px}
</style>
</head>
<body>
<div id="content">
  <!-- ç›˜é¢ï¼šä¿æŒåŸåƒç´ /é€»è¾‘ï¼ˆæ•´ä½“ç¼©æ”¾ä»¥é€‚é…æ‰‹æœºï¼‰ -->
  <div class="scale-wrap">
    <div class="box">
      <div class="top">
        <div class="cell">ğŸŠ</div><div class="cell">ğŸ””</div><div class="cell">BAR</div>
        <div class="cell">BAR</div><div class="cell">ğŸ</div><div class="cell">ğŸ</div>
      </div>
      <div class="right">
        <div class="cell">ğŸ‹</div><div class="cell">ğŸ‰</div><div class="cell">ğŸ‰</div>
        <div class="cell lucky">LUCKY</div><div class="cell">ğŸ</div><div class="cell">ğŸŠ</div>
      </div>
      <div class="bottom">
        <div class="cell">ğŸŠ</div><div class="cell">ğŸ””</div>
        <div class="cell double">77</div><div class="cell double">77</div>
        <div class="cell">ğŸ</div><div class="cell">ğŸ‹</div>
      </div>
      <div class="left">
        <div class="cell">ğŸ‹</div><div class="cell double">â˜…â˜…</div><div class="cell double">â˜…â˜…</div>
        <div class="cell lucky">LUCKY</div><div class="cell">ğŸ</div><div class="cell">ğŸ””</div>
      </div>

      <!-- é«˜äº®æ¡†ï¼ˆé»„è‰²æè¾¹/å…‰æ™•ï¼Œä¸é®å†…å®¹ï¼‰ -->
      <span id="move"></span>

      <!-- é‡‘é¢ -->
      <span id="getScore">ä¸­å¥–é‡‘é¢<p>0</p ></span>
      <span id="allScore">å½“å‰ä½™é¢<p>100</p ></span>
      <button id="change">å……å€¼ï¿¥100</button>

      <!-- ä¿ç•™åŸä¸‹æ³¨ç»“æ„ï¼ˆé¡ºåºï¼šè‹¹æœ/æ©™å­/æŸ æª¬/å°é“ƒé“›/åŒæ˜Ÿ/åŒ7/BARï¼‰ -->
      <div class="stake">
        <div class="stake_left">
          <div><button class="minus">-</button><span>0</span><button class="add">+</button></div>
          <div><button class="minus">-</button><span>0</span><button class="add">+</button></div>
          <div><button class="minus">-</button><span>0</span><button class="add">+</button></div>
          <div><button class="minus">-</button><span>0</span><button class="add">+</button></div>
        </div>
        <div class="stake_right">
          <div><button class="minus">-</button><span>0</span><button class="add">+</button></div>
          <div><button class="minus">-</button><span>0</span><button class="add">+</button></div>
          <div><button class="minus">-</button><span>0</span><button class="add">+</button></div>
          <div><button class="minus">-</button><span>0</span><button class="add">+</button></div>
        </div>
      </div>

      <!-- âœ… åº•éƒ¨ä¸€æ’ï¼šæ­£å¥½åœ¨åŒ7ä¸‹é¢ï¼Œéš” 1 ä¸ªå›¾æ ‡é«˜åº¦ï¼›å’Œç›˜é¢ä¸€æ ·å±…ä¸­ã€åŒå°ºå¯¸ -->
      <div class="controlbar">
        <button class="btn-icon" id="bet-apple">ğŸ<span class="badge" id="val-apple">0</span></button>
        <button class="btn-icon" id="bet-orange">ğŸŠ<span class="badge" id="val-orange">0</span></button>
        <button class="btn-icon" id="bet-lemon">ğŸ‹<span class="badge" id="val-lemon">0</span></button>
        <button class="btn-icon" id="bet-bellS">ğŸ””<span class="badge" id="val-bellS">0</span></button>
        <button class="btn-icon" id="bet-watermelon">ğŸ‰<span class="badge" id="val-watermelon">0</span></button>
        <button class="btn-icon btn-text" id="bet-stars">â˜…â˜…<span class="badge" id="val-stars">0</span></button>
        <button class="btn-icon btn-text" id="bet-seven">77<span class="badge" id="val-seven">0</span></button>
        <button class="btn-icon btn-text" id="bet-bar">BAR<span class="badge" id="val-bar">0</span></button>
        <button class="btn-icon btn-text begin">å¼€å§‹</button>
      </div>
    </div>
  </div>

  <p class="note">æ­¤ç¨‹åºç”±å¥¥ç‰¹ç»´Jerryå¼€å‘</p >
</div>

<script>
window.addEventListener('load', function () {
  /* ========= å£°éŸ³ï¼šWeb Audio API ========= */
  let actx=null, tickTimer=null;
  const ensureAudio=()=>{ if(!actx){ actx=new (window.AudioContext||window.webkitAudioContext)(); } };
  function beep(freq=440, dur=80, vol=0.15){
    ensureAudio(); const o=actx.createOscillator(), g=actx.createGain();
    o.type='sine'; o.frequency.value=freq; g.gain.value=vol;
    o.connect(g); g.connect(actx.destination);
    const now=actx.currentTime; o.start(now); o.stop(now+dur/1000);
  }
  function clickSound(){ beep(520,60,0.18); }
  function startTicks(){ if(tickTimer) return; tickTimer=setInterval(()=>beep(740,40,0.10),140); }
  function stopTicks(){ if(tickTimer){ clearInterval(tickTimer); tickTimer=null; } }
  function winSound(){ [660,880,990].forEach((f,i)=>setTimeout(()=>beep(f,90,0.2), i*110)); }

  /* ========= åŸæœ‰å…ƒç´ ä¸å˜é‡ ========= */
  var begin=document.querySelector('.begin');
  var move=document.querySelector('#move');
  var getScore=document.querySelector('#getScore>p');
  var allScore=document.querySelector('#allScore>p');
  var change=document.querySelector('#change');

  // åŸä¸‹æ³¨ç»“æ„ï¼ˆéšè—ä½†ä¿ç•™ï¼‰
  var pours=document.querySelectorAll('.stake span');
  var add=document.querySelectorAll('.stake .add');
  var minus=document.querySelectorAll('.stake .minus');

  // æ–°ä¸‹æ³¨å›¾æ ‡ï¼ˆé¡ºåºå¿…é¡»åŒ¹é… reward(1..8)ï¼‰
  var ids=['apple','orange','lemon','bellS','watermelon','stars','seven','bar'];
  var icons=ids.map(id=>document.querySelector('#bet-'+id));
  var badges=ids.map(id=>document.querySelector('#val-'+id));

  var timer=null,time=null,flag=null,Score=100;

  change.addEventListener('click',function(){ allScore.innerText = (Score+=100); clickSound(); });

  // ç‚¹å‡»ä¸‹æ³¨ï¼š+1ï¼ˆåˆ°100å›0ï¼‰ï¼Œå¹¶æ‰£ä½™é¢ 1
  icons.forEach((btn,i)=>{
    btn.addEventListener('click',function(){
      if(Score<=0){ alert('æ‚¨çš„ä½™é¢å·²ä¸è¶³ï¼Œè¯·å……å€¼åå†ä¸‹æ³¨'); return; }
      let v=parseInt(pours[i].innerText||'0',10);
      v = (v>=100) ? 0 : (v+1);
      pours[i].innerText=v; badges[i].innerText=v;
      Score--; allScore.innerText=Score;
      clickSound();
    });
  });

  // å¼€å§‹ï¼šä¿æŒåŸé€»è¾‘
  begin.addEventListener('click',function(){
    move.style.left='150px'; move.style.top='50px';
    clickMove(Score);
    clickSound();
  });

  // ========= ä»¥ä¸‹ä¸ºä½ åŸæ¥çš„é€»è¾‘ï¼ˆä¸æ”¹ï¼‰ =========
  function clickMove(score){
    for(var i=0;i<pours.length;i++){ if(flag) break; decide_pour(pours[i]); }
    if(score===0){ alert('æ‚¨çš„ä½™é¢å·²ä¸è¶³ï¼Œè¯·å……å€¼åå†å¼€å§‹ï¼'); }
    else if(!flag){ alert('æ‚¨æœªä¸‹æ³¨ï¼Œè¯·ä¸‹æ³¨åå†å¼€å§‹ï¼'); }
    else{
      stopTicks(); startTicks();                 // å¼€å§‹è½¬åŠ¨éŸ³
      clearInterval(timer);
      var randNum=Math.ceil(Math.random()*200)*24;
      var scoreNum=Math.floor(randNum/20%24+1);
      timer=setInterval(function(){
        var L=move.offsetLeft,T=move.offsetTop;
        if(T===50 && L<=650){ move.style.left=L+100+'px'; }
        else if(L>=650 && T>=50 && T<=550){ move.style.top=T+100+'px'; }
        else if(T>=650 && L<=750 && L>=250){ move.style.left=L-100+'px'; }
        else if(L<=150 && T<=750 && T>50){ move.style.top=T-100+'px'; }
      },20);
      begin.disabled=true;
      for(var i=0;i<add.length;i++){ add[i].disabled=true; minus[i].disabled=true; }
      time=setTimeout(function(){
        clearInterval(timer); stopTicks();       // åœæ­¢è½¬åŠ¨éŸ³
        setTimeout(function(){
          var s=0;
          switch(scoreNum){
            case 5:case 11:case 17:case 23: s=reward(1)*5; break;
            case 6: s=reward(1)*10; break;
            case 1:case 13: s=reward(2)*10; break;
            case 12: s=reward(2)*20; break;
            case 7:case 19: s=reward(3)*10; break;
            case 18: s=reward(3)*20; break;
            case 2:case 14: s=reward(4)*10; break;
            case 24: s=reward(4)*20; break;
            case 8: s=reward(5)*20; break;
            case 9: s=reward(5)*40; break;
            case 20: s=reward(6)*20; break;
            case 21: s=reward(6)*40; break;
            case 16: s=reward(7)*20; break;
            case 15: s=reward(7)*40; break;
            case 10:case 22: s=15; break;
            case 3: s=reward(8)*25; break;
            case 4: s=reward(8)*50; break;
          }
          getScore.innerText=s; sum(s); winSound();  // åœæ­¢æ—¶æç¤ºéŸ³
          for(var i=0;i<add.length;i++){
            add[i].previousElementSibling.innerText=0;
            if(badges[i]) badges[i].innerText='0';
            add[i].disabled=false; minus[i].disabled=false;
          }
          begin.disabled=false;
        },500);
        flag=false;
      },randNum);
    }
  }
  function decide_pour(obj){ var n=obj.innerText-0; flag=(n!==0); }
  function reward(n){ return pours[n-1].innerText-0; }
  function sum(score){ allScore.innerText=(parseInt(allScore.innerText,10)+score); Score=parseInt(allScore.innerText,10); }
});
</script>
</body>
</html>
